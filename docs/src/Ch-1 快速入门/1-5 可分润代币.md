# 1-5 可分润代币 Dividend-Paying Token

- [https://www.defidaonews.com/article/639606](https://www.defidaonews.com/article/639606)
- [https://www.facebook.com/groups/taipei.ethereum.meetup/posts/1072552632937910/](https://www.facebook.com/groups/taipei.ethereum.meetup/posts/1072552632937910/)

Crypto is all about incentive, and we all love passive incoming.

本节介绍可分润代币。第二章中 LP Token 的手续费，第三章、第五章中借贷协议和聚合器协议中的利息，以及更常见的流动性挖矿，它们都属于可分润代币。按照实现方式的不同，我们分为销毁、挖矿和生息三种模式分别讨论。

## 销毁模式

To be surprised, 最简单的可分润代币的实现方式是销毁。特别是在 EIP-1559 实施之后，区块的基本费用被销毁，矿工无法再获得。代币销毁虽然并不直观，但非常容易理解，例如在《游戏王》第一季中，海马濑人为了不让第四张青眼白龙流入市场，直接 burn 掉了从爷爷手上赢来的青眼白龙。

![image](https://user-images.githubusercontent.com/2507027/190903420-6b965ff3-2e69-4503-9cb4-a611d15dccbb.png)

根据规则，一张卡组最多只能携带三张同样的卡组，因而在总价值不变的情况下，这实际上让每张剩余的青眼白龙的价值都提高了。BNB 是另一个执行代币销毁的例子。代币销毁模式的缺陷是，如果不能做到线性平滑，那么在销毁的瞬时市场上代币的价格可能会有剧烈波动，另一方面币安的模式也需要强有力的中央机构的支持，它并不直观，使得庄家的优势被认为的扩大了。

## 挖矿模式

这一模式最早诞生自 PoWH，并在之后的流动性挖矿中被进一步发扬光大。这个合约要求我们，每当一笔利润产生时，我们需要可以 O(1) 的维护出每个用户根据抵押 Token 所能获得的比例，并且在中途用户还可以随时进行抵押和赎回操作。

方法是我们在合约中维护一个全局的单调递增变量 `uint ProfitPerShare` 表示每股分润，每当有新的收益产生时，就更新这个值。并且对每个用户维护它历史上已经取走了多少利润（或者等价的，它上一次取走利润的「时刻」[1^]），并在每次用户抵押和赎回时都进行维护。

[1^]: 实际是上一次 Claim 时的 `ProfitPerShare` 的值，因为 `ProfitPerShare` 是单调递增的，因此看起来也像是一个区块时间。

## 综合比较

这三种方式各有各自的优势，销毁模式最为简单甚至不需要写额外的代码，OpenZeppelin 里就有。

- [https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/token/ERC20/extensions/ERC20Burnable.sol](https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/token/ERC20/extensions/ERC20Burnable.sol)

挖矿模式最为常见，最适合流动性挖矿这种在某个时间段内会产生收益激励的场景，缺点是需要用户手工 `Claim()`，如果是有抵押操作则还需要`Stake()`、`Unstake()`。

生息模式最为高效，且一般说来因为有明确的计算公式，和 100% 刚兑，生息代币可直接在市场上流通，不需要进行频繁赎回，但是这也会创建出一种新的代币，产生更多的手续费并分散原生代币的流动性。

具体在实践中使用那种方案还需要根据具体的使用场景做判断，下面的表格列举了一些可分润代币的例子：

| 项目	   |    抵押物	  |  可分润代币  | 利润来源  | 分润模式 |
|----------|-------------|-------------|----------|---------|
| ETH      | ETH         | ETH         | 销毁     |  销毁  |
| stETH    | ETH         | stETH         | 增发     |  挖矿  |
| Uniswap  | A/B	     | LP Token    | 手续费 | 生息    |
| Unipool  | LP Token    | LP Token    | 激励池   |  挖矿  |
| P3D      | ETH         | P3D         | Ponzi   | 挖矿    |
| EOS Rex  | EOS	     | Rex         | 手续费  | 生息    |
| cDAI	   | DAI	     | cDAI        | 利息       | 生息    |
| yDAI	   | DAI	     | yDAI        | 利息       | 生息    |


我们来设计一个等价于 P3D 的生息代币。

在下一节要介绍的 Uniswap V2 中的 LP Token 和后续章节介绍的 cToken、yToken 都属于这种生息代币模式。



